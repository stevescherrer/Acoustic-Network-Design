## Script for testing if two transmitters perform equally well
## 04.02.2013
rm(list=ls())

T <- 120*60 ## Time of a trial
N <- 2 ## Number of tags in test

pr <- rep(0,N) ## Ping rate of each tag
pr[1] <- 120 
pr[2] <- 120

n <- rep(0,N) ## Expected number of pings
n[1] <- T/pr[1]
n[2] <- T/pr[2]

x <- rep(0,N) ## Number of successes (received pings)
x[1] <- round(0.9*n[1])
x[2] <- round(0.8*n[2])

prop.test(x,n)


## Sample size calculator (http://www.cct.cuhk.edu.hk/stat/proportion/Casagrande.htm)
P1 <- 0.9
P2 <- 0.8
r <- 1 ## r = 1 implies that the two sample sizes are identical
alpha <- 0.05/2 ## Divide by 2 to get two sided results (P1=P2 versus P1 neq P2)
beta <- 0.05

delta <- abs(P1-P2)
Pbar <- (P1+r*P2)/(r+1)
Qbar <- 1-Pbar

zalpha <- qnorm(1-alpha)
zbeta <- qnorm(1-beta)

mprime <- (zalpha*sqrt((r+1)*Pbar*Qbar) + zbeta*sqrt(r*P1*(1-P1)+P2*(1-P2)))^2/(r*delta^2)

m <- mprime/4*(1+sqrt(1+ (2*(r+1))/(r*mprime*delta)))^2

N <- (r+1)*m
